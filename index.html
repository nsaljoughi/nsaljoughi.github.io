
<!DOCTYPE html>
<html>
  <head>
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
    <script src="https://rawgit.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.min.js"></script>
    <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script> 
<script>  
    AFRAME.registerComponent('click-handler', {
        init: function () {
            const id =  this.el.id.match(/\d+$/)[0];
            const animatedMarker = document.querySelector(`#marker_${id}`);
            const aEntity = document.querySelector(`#quest_${id}`);

            animatedMarker.addEventListener('click', function (ev, target) {
                const intersectedElement = ev && ev.detail && ev.detail.intersectedEl;
                if (aEntity && intersectedElement === aEntity && animatedMarker.object3D.visible == true) {
                    console.log(id);
                    alert('Marker ' + id)
                }
                else {
                }
            });
        }
    });

</script>
  </head>
    <body>
        <a-scene
            embedded
            arjs='sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;'>

            <!-- Barcode markers -->
            <a-marker
                cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;"
                id="marker_1"
                type="barcode" 
                emitevents="true"
                value="1"
                smooth="true"
                smoothCount="10"
                smoothTolerance="0.01"
                smoothThreshold="2">
                <!-- Print boxes and a text on them --> 
                <!-- <a-box id="quest_1" click-handler="1" position="0.0 1.5 0.0" material="opacity: 0.75; color: red;">
                    <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #1 \n INFO; color:black;">
                    </a-entity>
                </a-box> -->
               <a-entity geometry="primitive: plane" id="quest_1" click-handler="1" rotation="-90 0 0" position="0.0 1.5 0.0" color="#CCC" height="5" width="5" look-at="[camera]"> 
            	     <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #1 \n INFO; color:black;">
                   </a-entity>
               </a-entity>
            </a-marker>

            <a-marker
                cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;"
                id="marker_2"
                type="barcode"
                emitevents="true"
                value="2"
                smooth="true"
                smoothCount="10"
                smoothTolerance="0.01"
                smoothThreshold="2">
                <a-box id="quest_2" click-handler="2" position="0 1.5 0"  material="opacity: 0.75; color: green;">
            	    <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #2 \n INFO; color:black;">
                    </a-entity>
                </a-box>
            </a-marker>

            <a-marker
                cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;"
                id="marker_3"
                type="barcode"
                emitevents="true" 
                value="3"
                smooth="true"
                smoothCount="10"
                smoothTolerance="0.01"
                smoothThreshold="2">
                <!-- Print boxes and a text on them --> 
                <a-box id="quest_3" click-handler="3" position="0.0 1.5 0.0" material="opacity: 0.75; color: yellow;">
                    <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #3 \n INFO; color:black;">
                    </a-entity>
                </a-box>
            </a-marker>

            <a-marker
                cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;"
                id="marker_4"
                type="barcode"
                emitevents="true"
                value="4"
                smooth="true"
                smoothCount="10"
                smoothTolerance="0.01"
                smoothThreshold="2">
                <a-box id="quest_4" click-handler="4" position="0 1.5 0"  material="opacity: 0.75; color: blue;">
            	    <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #4 \n INFO; color:black;">
                    </a-entity>
                </a-box>
            </a-marker>

            <a-marker
                cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;"
                id="marker_5"
                type="barcode"
                emitevents="true"
                value="5"
                smooth="true"
                smoothCount="10"
                smoothTolerance="0.01"
                smoothThreshold="2">
                <a-box id="quest_5" click-handler="5" position="0 1.5 0"  material="opacity: 0.75; color: blue;">
            	    <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #5 \n INFO; color:black;">
                    </a-entity>
                </a-box>
            </a-marker>

            <a-marker
                cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;"
                id="marker_6"
                type="barcode"
                emitevents="true"
                value="6"
                smooth="true"
                smoothCount="10"
                smoothTolerance="0.01"
                smoothThreshold="2">
                <a-box id="quest_6" click-handler="6" position="0 1.5 0"  material="opacity: 0.75; color: blue;">
            	    <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #6 \n INFO; color:black;">
                    </a-entity>
                </a-box>
            </a-marker>

            <a-marker
                cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;"
                id="marker_7"
                type="barcode"
                emitevents="true"
                value="7"
                smooth="true"
                smoothCount="10"
                smoothTolerance="0.01"
                smoothThreshold="2">
                <a-box id="quest_7" click-handler="7" position="0 1.5 0"  material="opacity: 0.75; color: blue;">
            	    <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #7 \n INFO; color:black;">
                    </a-entity>
                </a-box>
            </a-marker>

            <a-marker
                cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;"
                id="marker_8"
                type="barcode"
                emitevents="true"
                value="8"
                smooth="true"
                smoothCount="10"
                smoothTolerance="0.01"
                smoothThreshold="2">
                <a-box id="quest_8" click-handler="8" position="0 1.5 0"  material="opacity: 0.75; color: blue;">
            	    <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #8 \n INFO; color:black;">
                    </a-entity>
                </a-box>
            </a-marker>

            <a-marker
                cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;"
                id="marker_9"
                type="barcode"
                emitevents="true"
                value="9"
                smooth="true"
                smoothCount="10"
                smoothTolerance="0.01"
                smoothThreshold="2">
                <a-box id="quest_9" click-handler="9" position="0 1.5 0"  material="opacity: 0.75; color: blue;">
            	    <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #9 \n INFO; color:black;">
                    </a-entity>
                </a-box>
            </a-marker>

            <a-marker
                cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;"
                id="marker_10"
                type="barcode"
                emitevents="true"
                value="10"
                smooth="true"
                smoothCount="10"
                smoothTolerance="0.01"
                smoothThreshold="2">
                <a-box id="quest_10" click-handler="10" position="0 1.5 0"  material="opacity: 0.75; color: blue;">
            	    <a-entity rotation="-90 0 0" position="1 0.55 -0.25" scale="3 3 3" text="value: Sensor #10 \n INFO; color:black;">
                    </a-entity>
                </a-box>
            </a-marker>
          
            <a-entity camera></a-entity>
        </a-scene>
    </body>
</html>
